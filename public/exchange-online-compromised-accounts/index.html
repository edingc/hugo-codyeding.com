<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.98.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Dealing with compromised accounts in Exchange Online &middot; Cody Eding</title>
  <meta name="description" content="Identify and remedy compromised Exchange Online accounts." />

  
  <link type="text/css" rel="stylesheet" href="https://codyeding.com/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://codyeding.com/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://codyeding.com/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://codyeding.com/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Source+Sans+Pro:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body class="theme-base-blue ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://codyeding.com/"><h1>Cody Eding</h1></a>
      <p class="lead">
       Random IT musings. 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://codyeding.com/">Home</a> </li>
        <li><a href="https://github.com/edingc/"> Github </a></li><li><a href="https://www.linkedin.com/in/username/"> LinkedIn </a></li><li><a href="https://twitter.com/edingc/"> Twitter </a></li>
      </ul>
    </nav>

    <p>&copy; 2022. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>Dealing with compromised accounts in Exchange Online</h1>
  <time datetime=2016-08-29T08:34:21-0600 class="post-date">Mon, Aug 29, 2016</time>
  <p>We have lately had a rash of compromised email accounts in our Office 365 Exchange Online infrastructure. It appears a well-crafted phishing email caught at least a small percentage of our 100,000-plus mailboxes.</p>
<p>The outbound SPAM protection in Office 365 and Exchange Online is very robust. Suspected SPAM messages are sent through a high-risk pool of IP addresses, and accounts are limited to 10,000 outbound messages per day before being blocked by the anti-SPAM intelligence. A support ticket must be filed with Microsoft to reactivate an account once it is blocked from sending outbound mail.</p>
<p>Normally, the anti-SPAM alerts received when an account hits the outbound message limit are sufficient for administrative notification. The most recent set of spammers, however, have been intelligently working underneath this notification system by sending less than 10,000 messages daily. The spammers instead cover their tracks by setting up email forwarding or an inbox rule to hide any bouncebacks from the slew of outbound junk.</p>
<p>Email forwarders victimized the most recent compromised accounts. These accounts came into the help desk with the same symptom of not receiving email messages. A look at the mailbox through Exchange Online PowerShell reveals the cause:</p>
<p><img src="/img/20160829-compromised-account.png" alt="PowerShell Prompt" title="Compromised Account"></p>
<p>The spammer set the mailbox to forward all mail to an external address under their control, thereby hiding the nefarious activities.</p>
<p>To remove the forwarder, run the following in PowerShell:</p>
<pre><code>Set-Mailbox jsmith@domain.com -ForwardingSmtpAddress $Null
</code></pre>
<p>In some cases, spammers will instead setup an inbox rule to hide their activity. View all inbox rules for a mailbox through PowerShell by running the following:</p>
<pre><code>Get-InboxRule -Mailbox jsmith@domain.com
</code></pre>
<p>For a clean mailbox, this should return nothing or return valid inbox rules created by the customer.</p>
<p>It never hurts to educate your customers on never giving out login information through an email!</p>

</div>

<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "codyeding" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </main>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-2714311-7', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
  </body>
</html>
